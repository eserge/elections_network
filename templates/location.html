{% extends "base.html" %}

{% block left_column %}
<h3>Участники</h3>
<div id="col1_content_observers" class="clearfix content_block">
    <b>Наблюдатели</b>
    <ul>
        {% for observer in participants.observer %}
        <li><a href="{{ observer.get_absolute_url }}">{{ observer.username }}</a></li>
        {% endfor %}
    </ul>
</div>
<div id="col1_content_voters" class="clearfix content_block">
    <b>Избиратели</b>
    <ul id="voters_ul">
        {% for voter in participants.voter %}
        <li><a href="{{ voter.get_absolute_url }}">{{ voter.username }}</a></li>
        {% endfor %}
    </ul>
    <button id="become_voter">{% if is_voter_here %}Голосовать в другом месте{% else %}Записаться в избиратели{% endif %}</button>
</div>
{% endblock %}

{% block right_column %}
<h3>Инструменты</h3>
<div class="clearfix content_block" id="col2_content_links">
    <b>Ссылки</b>
    <ul id="links_ul">
        {% for link in links %}
        <li><a href="{{ link.url }}" target="_blank">{{ link.name }}</a></li>
        {% endfor %}
    </ul>
    <button id="add_link">Добавить ссылку</button>
    <button id="report_link">Пожаловаться на ссылку</button>
</div>
{% endblock %}

{% block content %}

<h2>{{ location }}</h2>

<script type="text/javascript">
    VK.init({apiId: 2749623, onlyWidgets: true});
</script>

<div id="vk_comments"></div>
<script type="text/javascript">
VK.Widgets.Comments("vk_comments", {limit: 10, width: "496", attach: "*"});
</script>


<div id="add_link_dialog">
    Добавить ссылку
    <form id="add_link_form" method="post" action="{% url add_link %}">
        {% csrf_token %}
        <table>
            <tr>
                <td>Название</td>
                <td><input id="link_name_input" name="name" value="" /></td>
            </tr>
            <tr>
                <td>URL</td>
                <td><input id="link_url_input" name="url" value="" /></td>
            </tr>
        </table>
        <input type="hidden" name="location" value="{{ location.id }}" />
    </form>
    <button id="add_link_submit">Добавить</button>
</div>

<div id="report_link_dialog">
    Пожаловаться на ссылку
    <form id="report_link_form" method="post" action="{% url report_link %}">
        {% csrf_token %}
        <ul id="report_link_ul"></ul>
        <input type="hidden" name="location" value="{{ location.id }}" />
    </form>
    <button id="report_link_submit">Пожаловаться</button>
</div>

<div id="become_voter_dialog">
    Записаться в голосующие
    <form id="become_voter_form" method="post" action="{% url become_voter %}">
        {% csrf_token %}
        {% include "region_choice.html" %}
    </form>
    <button id="become_voter_submit">Добавить</button>
</div>

{% endblock %}